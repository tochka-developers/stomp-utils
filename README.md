# Stomp protocol utils

Набор классов-утилит для взаимодействия с брокетами сообщений (ActiveMQ, RabbitMQ, ZeroMQ и т.д.) по протоколу [Stomp](https://stomp.github.io/).
Пакет решает две наиболее распространенные задачи:
 - Отправка сообщения в очередь;
 - Получение сообщений из очеред в режиме демона.
Логирование можно осуществлять путем подключения любого PSR-совместимого логгера.

## Requirements
php 7.x

## Установка
Для установки пакета с использованием composer:
```bash
composer require stomp-utils
```

## Использование

### Отправка сообщения в очередь
```Publisher::send(string $destination, string $body[, array $headers][, string $transactionId])``` - отправляет сообщение в очередь.
Параметры:
 - $destination - Название очереди, куда отправлять сообщение;
 - $body - тело сообщения;
 - $headers - массив заголовков сообщения;
 - $transactionId - Идентификатор транзакции.
 
### Получение сообщений из очереди в режиме демона
Для начала необходимо реализовать класс, который будет обрабатывать полученное сообщение. Он должен наследоваться от класса ```Tochka\Integration\Stomp\BaseWorker``` и реализовывать метод ```handle()```.
Далее необходимо реализовать класс, который будет слушать сообщения из очереди. Класс должен наследоваться от ```Tochka\Integration\Stomp\Listener```. В классе нужно переопределить метод ```generateHandler()```, который должен возвращать объект-обработчик сообщения, который должен являться экземпляром ```Tochka\Integration\Stomp\BaseWorker```.
